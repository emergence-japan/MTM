<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title data-i18n="gameTitle">What Matters to Me</title>
  <link rel="stylesheet" href="css/variables.css">
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/survey.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Lora:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
</head>

<body>

  <div id="language-switcher-container" style="position: absolute; top: 20px; right: 20px; z-index: 1000;"></div>

  <div id="participant-input-container"></div>

  <!-- Welcome Screen -->
  <section id="welcome" class="screen">
    <div class="content-wrapper">
      <h1 class="title" data-i18n="gameTitle">What Matters to Me</h1>

      <div id="welcome-message" style="margin-bottom: 1.5rem;">
        <!-- Participant name will be injected here -->
      </div>
      
      <button class="btn-primary" onclick="navigateTo('important-notes')" data-i18n="btnStart">
        ゲームを開始する
      </button>
    </div>
  </section>

  <!-- Important Notes (Intro) -->
  <section id="important-notes" class="screen">
    <div class="content-wrapper">
      <h2 data-i18n="introHeader">はじめに</h2>

      <div class="notes-box">
        <p data-i18n="introText1">このアクティビティでは、日常生活の中で自分にとって何が大切なのか、立ち止まって考えてみましょう。</p>
        <p data-i18n="introText2">テストや評価ではなく、あなたが何を大切にしているのか、なぜ大切にしているのかに気づく機会です。</p>
        <p data-i18n="introText3">時間をかけて、正直に答えてください。正解も不正解もありません。</p>
        
        <h3 data-i18n="remarksHeader" style="margin-top: 1.5rem;">備考</h3>
        <ul>
          <li data-i18n="remark1">所要時間の目安：約25～30分。</li>
          <li data-i18n="remark2">疲れたり、不快に感じたりした場合は、いつでも中断してかまいません。</li>
          <li data-i18n="remark3">あなたの回答は秘密であり、採点・評価されることはありません。</li>
          <li data-i18n="remark4">目的は自己理解と自覚であり、パフォーマンスではありません。</li>
        </ul>
      </div>

      <button class="btn-primary" onclick="navigateTo('step1')" data-i18n="btnUnderstand">
        理解して体験を開始する
      </button>
    </div>
  </section>

  <!-- Step 1 & 2: Listing and Ranking (Placeholder) -->
  <section id="step1" class="screen">
    <div class="content-wrapper">
        <h2 data-i18n="step1Title">ステップ1 & 2</h2>
        <!-- Content will be implemented in next task -->
        <button class="btn-primary" onclick="navigateTo('step3')">Next</button>
    </div>
  </section>

  <!-- Step 3: Deep Thinking (Placeholder) -->
  <section id="step3" class="screen">
    <div class="content-wrapper">
        <h2 data-i18n="step3Title">ステップ3</h2>
        <!-- Content will be implemented in next task -->
        <button class="btn-primary" onclick="navigateTo('step4')">Next</button>
    </div>
  </section>

  <!-- Step 4: Summary (Placeholder) -->
  <section id="step4" class="screen">
    <div class="content-wrapper">
        <h2 data-i18n="step4Title">ステップ4</h2>
        <!-- Content will be implemented in next task -->
        <button class="btn-primary" onclick="completeGameAndSend()">Finish</button>
    </div>
  </section>

  <!-- Completion Screen -->
  <section id="completion" class="screen">
    <div class="content-wrapper completion-content">
      <h1 class="completion-title" data-i18n="gameTitle">What Matters to Me</h1>

      <div class="completion-message">
        <p data-i18n="completionMsg1">この体験が、あなたの健康と幸福の支えとなり、より充実した人生を送る一助となることを願っています。</p>
        <p data-i18n="completionMsg2">本当にありがとうございました。</p>
      </div>

      <a href="index.html" class="btn-primary" style="margin-top: 2rem;" data-i18n="btnBackToTop">トップに戻る</a>

      <p class="copyright">©Hironori SAKAI 2025</p>
    </div>
  </section>

  <script src="js/participant.js"></script>
  <script src="js/input-form.js"></script>
  <script src="js/submit.js"></script>
  <script src="js/app.js"></script>
  <script src="js/i18n.js"></script>
  <script src="js/language-switcher.js"></script>
  
  <script>
    // Translations for Game Page
    const gameTranslations = {
      ja: {
        gameTitle: "What Matters to Me",
        btnStart: "ゲームを開始する",
        introHeader: "はじめに",
        introText1: "このアクティビティでは、日常生活の中で自分にとって何が大切なのか、立ち止まって考えてみましょう。",
        introText2: "テストや評価ではなく、あなたが何を大切にしているのか、なぜ大切にしているのかに気づく機会です。",
        introText3: "時間をかけて、正直に答えてください。正解も不正解もありません。",
        remarksHeader: "備考",
        remark1: "所要時間の目安：約25～30分。",
        remark2: "疲れたり、不快に感じたりした場合は、いつでも中断してかまいません。",
        remark3: "あなたの回答は秘密であり、採点・評価されることはありません。",
        remark4: "目的は自己理解と自覚であり、パフォーマンスではありません。",
        btnUnderstand: "理解して体験を開始する",
        step1Title: "ステップ1 & 2 - 整理",
        step3Title: "ステップ3 - 深く考える",
        step4Title: "ステップ4 - まとめ",
        completionMsg1: "この体験が、あなたの健康と幸福の支えとなり、より充実した人生を送る一助となることを願っています。",
        completionMsg2: "本当にありがとうございました。",
        btnBackToTop: "トップに戻る",
        welcomeMsg: "ようこそ, {name} さん"
      },
      en: {
        gameTitle: "What Matters to Me",
        btnStart: "Start Activity",
        introHeader: "Introduction",
        introText1: "This activity invites you to pause and reflect on what matters to you in daily life.",
        introText2: "It is not a test or evaluation, but an opportunity to notice what you value and why.",
        introText3: "Please take your time and answer honestly. There are no right or wrong answers.",
        remarksHeader: "Remarks",
        remark1: "Estimated time: 25-30 minutes.",
        remark2: "You may stop at any time if you feel tired or uncomfortable.",
        remark3: "Your answers are private and will not be graded or evaluated.",
        remark4: "The goal is self-understanding and awareness, not performance.",
        btnUnderstand: "I understand, start activity",
        step1Title: "Step 1 & 2 - Organizing",
        step3Title: "Step 3 - Deep Thinking",
        step4Title: "Step 4 - Summary",
        completionMsg1: "We hope this experience supports your health and happiness and helps you lead a more fulfilling life.",
        completionMsg2: "Thank you very much.",
        btnBackToTop: "Back to Top",
        welcomeMsg: "Welcome, {name}"
      }
    };

    document.addEventListener('DOMContentLoaded', () => {
      const i18n = new I18n(gameTranslations);
      const switcherContainer = document.getElementById('language-switcher-container');
      const switcher = new LanguageSwitcher(i18n, switcherContainer);
      switcher.render();
      i18n.updateDOM();

      const container = document.getElementById('participant-input-container');

      requireParticipantOrInput(container, () => {
        const participant = getParticipant();
        
        // ウェルカムメッセージの表示
        const welcomeMessageEl = document.getElementById('welcome-message');
        if (welcomeMessageEl) {
          const msg = i18n.t('welcomeMsg').replace('{name}', `<strong style="color: var(--color-primary);">${participant.anonymousCode}</strong>`);
          welcomeMessageEl.innerHTML = `<p class="subtitle" style="color: white;">${msg}</p>`;
        }
        
        // 最初の画面を表示
        document.getElementById('welcome').classList.add('active');
      });
    });
  </script>
</body>

</html>